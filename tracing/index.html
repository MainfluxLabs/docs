<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://mainflux.com/index.html/tracing/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Tracing - MainfluxLabs</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Tracing";
        var mkdocs_page_input_path = "tracing.md";
        var mkdocs_page_url = "/index.html/tracing/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> MainfluxLabs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Overview</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../architecture/">Architecture</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../getting-started/">Getting Started</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../authentication/">Authentication</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../authorization/">Authorization</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../api/">API</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../messaging/">Messaging</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../storage/">Storage</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../edge/">Edge</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../security/">Security</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../cli/">CLI</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Tracing</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#launch">Launch</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#configure">Configure</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#example">Example</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../dev-guide/">Developer's Guide</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../kubernetes/">Kubernetes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../benchmark/">Benchmark</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../enterprise/">Enterprise</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">MainfluxLabs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Tracing</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="tracing">Tracing<a class="headerlink" href="#tracing" title="Permanent link">#</a></h1>
<p>Distributed tracing is a method of profiling and monitoring applications.  It can provide valuable insight when optimizing and debugging an application.  Mainflux includes the <a href="https://www.jaegertracing.io">Jaeger</a> open tracing framework as a service with its stack by default.</p>
<h2 id="launch">Launch<a class="headerlink" href="#launch" title="Permanent link">#</a></h2>
<p>The Jaeger service will launch with the rest of the Mainflux services.  All services can be launched using:</p>
<pre><code class="language-bash">make run
</code></pre>
<p>The Jaeger UI can then be accessed at <code>http://localhost:16686</code> from a browser.  Details about the UI can be found in <a href="https://www.jaegertracing.io/docs/1.14/frontend-ui/">Jaeger's official documentation</a>.</p>
<h2 id="configure">Configure<a class="headerlink" href="#configure" title="Permanent link">#</a></h2>
<p>The Jaeger service can be disabled by using the <code>scale</code> flag with <code>docker-compose up</code> and setting the jaeger container to 0.</p>
<pre><code class="language-bash">--scale jaeger=0
</code></pre>
<p><code>make rungw</code> will run all of the Mainflux services except for the Jaeger service.  This is currently the only difference from <code>make run</code>.  </p>
<blockquote>
<p>The <code>make rungw</code> command runs Mainflux for gateway devices.  There could potentially be more differences running with this command in the future.</p>
</blockquote>
<p>Jaeger uses 5 ports within the Mainflux framework.  These ports can be edited in the <code>.env</code> file.</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>MF_JAEGER_PORT</td>
<td>Agent port for compact jaeger.thrift protocol</td>
<td>6831</td>
</tr>
<tr>
<td>MF_JAEGER_FRONTEND</td>
<td>UI port</td>
<td>16686</td>
</tr>
<tr>
<td>MF_JAEGER_COLLECTOR</td>
<td>Collector for jaeger.thrift directly from clients</td>
<td>14268</td>
</tr>
<tr>
<td>MF_JAEGER_CONFIGS</td>
<td>Configuration server</td>
<td>5778</td>
</tr>
<tr>
<td>MF_JAEGER_URL</td>
<td>Jaeger access from within Mainflux</td>
<td>jaeger:6831</td>
</tr>
</tbody>
</table>
<h2 id="example">Example<a class="headerlink" href="#example" title="Permanent link">#</a></h2>
<p>As an example for using Jaeger, we can look at the traces generated after provisioning the system.  Make sure to have ran the provisioning script that is part of the <a href="../getting-started/">Getting Started</a> step.</p>
<p>Before getting started with Jaeger, there are a few terms that are important to define.  A <code>trace</code> can be thought of as one transaction within the system.  A trace is made up of one or more <code>spans</code>.  These are the individual steps that must be taken for a trace to perform its action.  A span has <code>tags</code> and <code>logs</code> associated with it.  Tags are key-value pairs that provide information such as a database type or http method. Tags are useful when filtering traces in the Jaeger UI.  Logs are structured messages used at specific points in the trace's transaction.  These are typically used to indicate an error.</p>
<p>When first navigating to the Jaeger UI, it will present a search page with an empty results section.  There are multiple fields to search from including service, operation, tags and time frames.  Clicking <code>Find Traces</code> will fill the results section with traces containing the selected fields.</p>
<p><img alt="Search page with results" src="../img/tracing/search.png" /></p>
<p>The top of the results page includes a scatter plot of the traces and their durations.  This can be very useful for finding a trace with a prolonged runtime.  Clicking on one of the points will open the trace page of that trace.</p>
<p>Below the graph is a list of all the traces with a summary of its information. Each trace shows a unique identifier, the overall runtime, the spans it is composed of and when it was ran.  Clicking on one of the traces will open the trace page of that trace.</p>
<p><img alt="Trace page with expanded spans" src="../img/tracing/trace.png" /></p>
<p>The trace page provides a more detailed breakdown of the individual span calls.  The top of the page shows a chart breaking down what spans the trace is spending its time in.  Below the chart are the individual spans and their details.  Expanding the spans shows any tags associated with that span and process information.  This is also where any errors or logs seen while running the span will be reported.</p>
<p>This is just a brief overview of the possibilities of Jaeger and its UI.  For more information, check out <a href="https://www.jaegertracing.io/docs/1.14/frontend-ui/">Jaeger's official documentation</a>.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../cli/" class="btn btn-neutral float-left" title="CLI"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../dev-guide/" class="btn btn-neutral float-right" title="Developer's Guide">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright (c) MainfluxLabs</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/MainfluxLabs/mainflux" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../cli/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../dev-guide/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
